# PromiseCard v1 ì„¤ê³„ì„œ

> ì‘ì„±ì¼: 2025-02-01
> ë²„ì „: v1.0

---

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
[ì‚¬ìš©ì]
    â†“
[Vercel Edge Network]
    â†“
[Next.js App]
    â”œâ”€â”€ ì •ì  í˜ì´ì§€ (SSG)
    â”œâ”€â”€ ë™ì  í˜ì´ì§€ (SSR)
    â””â”€â”€ API Routes
          â†“
    [Supabase]
     â”œâ”€â”€ Auth (ì¸ì¦)
     â”œâ”€â”€ Database (PostgreSQL)
     â””â”€â”€ Storage (ì´ë¯¸ì§€)
          â†“
    [Cloudinary] (ì´ë¯¸ì§€ ìµœì í™”)
```

---

## 2. ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ë¥˜ | ê¸°ìˆ  | ë²„ì „ |
|------|------|------|
| Framework | Next.js | 14.x |
| Language | TypeScript | 5.x |
| Styling | Tailwind CSS | 3.x |
| Backend | Supabase | - |
| Database | PostgreSQL | 15.x |
| Deployment | Vercel | - |
| Image CDN | Cloudinary | - |
| Design | Figma | - |

---

## 2.1 ë””ìì¸ ì›Œí¬í”Œë¡œìš°

### ë„êµ¬

| ë„êµ¬ | ìš©ë„ |
|------|------|
| **Figma** | UI/UX ë””ìì¸ |
| **Figma MCP** | Claude Code ì—°ë™ |

### í”„ë¡œì„¸ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Figma     â”‚ â†’ â”‚  MCP ì—°ê²°   â”‚ â†’ â”‚   Claude    â”‚ â†’ â”‚  ì½”ë“œ ë¦¬ë·°   â”‚
â”‚  UI ë””ìì¸   â”‚    â”‚             â”‚    â”‚  ì½”ë“œ êµ¬í˜„   â”‚    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     ì‚¬ìš©ì              ì‚¬ìš©ì            Claude            ì‚¬ìš©ì
```

### ë””ìì¸ ê·œì¹™

1. **ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ì„¤ê³„**
   - Figma ì»´í¬ë„ŒíŠ¸ = React ì»´í¬ë„ŒíŠ¸
   - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë‹¨ìœ„ë¡œ ë¶„ë¦¬

2. **ë„¤ì´ë° ì»¨ë²¤ì…˜**
   - ì»´í¬ë„ŒíŠ¸: `Category/ComponentName` (ì˜ˆ: `Button/Primary`)
   - ë ˆì´ì–´: ì˜ë¯¸ ìˆëŠ” ì´ë¦„ ì‚¬ìš©

3. **ë””ìì¸ í† í°**
   - ìƒ‰ìƒ: Figma Variables ì‚¬ìš©
   - ê°„ê²©: 8px ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ
   - í°íŠ¸: ì •ì˜ëœ ìŠ¤íƒ€ì¼ë§Œ ì‚¬ìš©

### Figma â†’ ì½”ë“œ ë§¤í•‘

| Figma | Tailwind/React |
|-------|----------------|
| Auto Layout (horizontal) | `flex flex-row` |
| Auto Layout (vertical) | `flex flex-col` |
| Gap: 16px | `gap-4` |
| Padding: 16px | `p-4` |
| Fill Container | `w-full` |
| Fixed Width: 200px | `w-[200px]` |
| Corner Radius: 8px | `rounded-lg` |

### MCP ì—°ê²° ì„¤ì •

```json
// .mcp.json
{
  "mcpServers": {
    "figma": {
      "command": "npx",
      "args": ["-y", "@anthropic/figma-mcp"]
    }
  }
}
```

---

## 3. í´ë” êµ¬ì¡°

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”‚   â””â”€â”€ signup/page.tsx
â”‚   â”œâ”€â”€ (main)/
â”‚   â”‚   â”œâ”€â”€ page.tsx              # í™ˆ
â”‚   â”‚   â”œâ”€â”€ templates/page.tsx    # í…œí”Œë¦¿ ëª©ë¡
â”‚   â”‚   â””â”€â”€ create/page.tsx       # ì²­ì²©ì¥ ìƒì„±
â”‚   â”œâ”€â”€ card/
â”‚   â”‚   â””â”€â”€ [code]/page.tsx       # ì²­ì²©ì¥ ë³´ê¸°
â”‚   â”œâ”€â”€ my/
â”‚   â”‚   â””â”€â”€ page.tsx              # ë§ˆì´í˜ì´ì§€
â”‚   â””â”€â”€ layout.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                       # ê¸°ë³¸ UI
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â””â”€â”€ Card.tsx
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ InvitationForm.tsx    # ì²­ì²©ì¥ ì…ë ¥ í¼
â”‚   â”‚   â”œâ”€â”€ InvitationPreview.tsx # ë¯¸ë¦¬ë³´ê¸°
â”‚   â”‚   â”œâ”€â”€ TemplateSelector.tsx  # í…œí”Œë¦¿ ì„ íƒ
â”‚   â”‚   â””â”€â”€ ShareButton.tsx       # ê³µìœ  ë²„íŠ¼
â”‚   â””â”€â”€ layout/
â”‚       â”œâ”€â”€ Header.tsx
â”‚       â”œâ”€â”€ Footer.tsx
â”‚       â””â”€â”€ MobileNav.tsx
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â””â”€â”€ server.ts
â”‚   â””â”€â”€ utils.ts
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useInvitation.ts
â”‚   â””â”€â”€ useAuth.ts
â””â”€â”€ types/
    â”œâ”€â”€ invitation.ts
    â””â”€â”€ database.ts
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 4.1 ERD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚       â”‚ invitation_cardsâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚â”€â”€â”€â”€â”€â”€<â”‚ user_id (FK)    â”‚
â”‚ email           â”‚       â”‚ id (PK)         â”‚
â”‚ created_at      â”‚       â”‚ template_id     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ groom_name      â”‚
                          â”‚ bride_name      â”‚
                          â”‚ wedding_date    â”‚
                          â”‚ venue_*         â”‚
                          â”‚ share_code (UQ) â”‚
                          â”‚ status          â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                       â”‚                       â”‚
           â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ rsvp_responses  â”‚   â”‚guestbook_entriesâ”‚   â”‚ card_gallery    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚   â”‚ id (PK)         â”‚   â”‚ id (PK)         â”‚
â”‚ card_id (FK)    â”‚   â”‚ card_id (FK)    â”‚   â”‚ card_id (FK)    â”‚
â”‚ guest_name      â”‚   â”‚ author_name     â”‚   â”‚ image_url       â”‚
â”‚ attending       â”‚   â”‚ message         â”‚   â”‚ order           â”‚
â”‚ guest_count     â”‚   â”‚ created_at      â”‚   â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ì£¼ìš” í…Œì´ë¸”

ìƒì„¸ ìŠ¤í‚¤ë§ˆëŠ” `.claude/skills/invitation.md` ì°¸ì¡°

---

## 5. API ì„¤ê³„

### 5.1 ì²­ì²©ì¥ API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/api/cards` | ë‚´ ì²­ì²©ì¥ ëª©ë¡ |
| POST | `/api/cards` | ì²­ì²©ì¥ ìƒì„± |
| GET | `/api/cards/[id]` | ì²­ì²©ì¥ ì¡°íšŒ |
| PUT | `/api/cards/[id]` | ì²­ì²©ì¥ ìˆ˜ì • |
| DELETE | `/api/cards/[id]` | ì²­ì²©ì¥ ì‚­ì œ |
| GET | `/api/cards/code/[code]` | ê³µìœ  ì½”ë“œë¡œ ì¡°íšŒ |

### 5.2 ì´ë¯¸ì§€ API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/upload` | ì´ë¯¸ì§€ ì—…ë¡œë“œ |
| DELETE | `/api/upload/[id]` | ì´ë¯¸ì§€ ì‚­ì œ |

### 5.3 RSVP API (v1.1)

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/rsvp` | ì°¸ì„ ì—¬ë¶€ ë“±ë¡ |
| GET | `/api/rsvp/[cardId]` | ì°¸ì„ì ëª©ë¡ |

---

## 6. í™”ë©´ ì„¤ê³„

### 6.1 í˜ì´ì§€ ëª©ë¡

| í˜ì´ì§€ | ê²½ë¡œ | ì„¤ëª… |
|--------|------|------|
| í™ˆ | `/` | ëœë”© í˜ì´ì§€ |
| í…œí”Œë¦¿ | `/templates` | í…œí”Œë¦¿ ì„ íƒ |
| ìƒì„± | `/create` | ì²­ì²©ì¥ ìƒì„± |
| ë¯¸ë¦¬ë³´ê¸° | `/preview/[id]` | ë¯¸ë¦¬ë³´ê¸° |
| ì²­ì²©ì¥ | `/card/[code]` | ê³µê°œ ì²­ì²©ì¥ |
| ë¡œê·¸ì¸ | `/login` | ë¡œê·¸ì¸ |
| ë§ˆì´í˜ì´ì§€ | `/my` | ë‚´ ì²­ì²©ì¥ |

### 6.2 ì™€ì´ì–´í”„ë ˆì„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PromiseCard               â”‚
â”‚         ëª¨ë°”ì¼ ì²­ì²©ì¥ ì„œë¹„ìŠ¤          â”‚
â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚   ì²­ì²©ì¥ ë§Œë“¤ê¸° ë²„íŠ¼      â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚í…œí”Œë¦¿â”‚ â”‚í…œí”Œë¦¿â”‚ â”‚í…œí”Œë¦¿â”‚        â”‚
â”‚    â”‚  1  â”‚ â”‚  2  â”‚ â”‚  3  â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                     â”‚
â”‚    ê³ ê°í›„ê¸° | FAQ | ê³ ê°ì„¼í„°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

### 7.1 UI ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | Props | ì„¤ëª… |
|----------|-------|------|
| Button | variant, size, disabled | ë²„íŠ¼ |
| Input | label, error, type | ì…ë ¥ í•„ë“œ |
| Card | children, className | ì¹´ë“œ ì»¨í…Œì´ë„ˆ |
| Modal | open, onClose, title | ëª¨ë‹¬ |
| DatePicker | value, onChange | ë‚ ì§œ ì„ íƒ |

### 7.2 ê¸°ëŠ¥ ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | Props | ì„¤ëª… |
|----------|-------|------|
| InvitationForm | onSubmit, defaultValues | ì²­ì²©ì¥ í¼ |
| TemplateSelector | templates, onSelect | í…œí”Œë¦¿ ì„ íƒ |
| InvitationPreview | data, template | ë¯¸ë¦¬ë³´ê¸° |
| ShareButton | shareCode, title | ê³µìœ  ë²„íŠ¼ |
| ImageUploader | onUpload, maxFiles | ì´ë¯¸ì§€ ì—…ë¡œë“œ |

---

## 8. ìƒíƒœ ê´€ë¦¬

### 8.1 ì„œë²„ ìƒíƒœ
- **Supabase Realtime** ë˜ëŠ” **React Query**

### 8.2 í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ
- **React useState** (ê°„ë‹¨í•œ ìƒíƒœ)
- **Zustand** (ì „ì—­ ìƒíƒœ, í•„ìš”ì‹œ)

---

## 9. ì¸ì¦ ì„¤ê³„

### 9.1 ë¡œê·¸ì¸ ìˆ˜ë‹¨ (ë² íŠ¸ë‚¨ í˜„ì§€í™”)

> ë² íŠ¸ë‚¨ SNS ì‚¬ìš©ë¥  ê¸°ë°˜ (2024-2025)

#### í•„ìˆ˜ (P0)

| ìˆ˜ë‹¨ | ì‚¬ìš©ì ìˆ˜ | ìš°ì„ ìˆœìœ„ | ë¹„ê³  |
|------|----------|----------|------|
| **Zalo** | 7,760ë§Œ | 1ìˆœìœ„ | ë² íŠ¸ë‚¨ êµ­ë¯¼ ì•± |
| **Facebook** | 7,270ë§Œ | 2ìˆœìœ„ | ê¸€ë¡œë²Œ + í˜„ì§€ |
| **Google** | 6,300ë§Œ | 3ìˆœìœ„ | ê¸€ë¡œë²Œ í‘œì¤€ |

#### ê¶Œì¥ (P1)

| ìˆ˜ë‹¨ | ìš°ì„ ìˆœìœ„ | ë¹„ê³  |
|------|----------|------|
| **ì „í™”ë²ˆí˜¸ ì¸ì¦** | í•„ìˆ˜ | Decree 147/2024 ë²•ë ¹ ì¤€ìˆ˜ |

#### ì„ íƒ (P2)

| ìˆ˜ë‹¨ | ìš°ì„ ìˆœìœ„ | ë¹„ê³  |
|------|----------|------|
| **Kakao** | í•œêµ­ì¸ ëŒ€ìƒ | ë² íŠ¸ë‚¨ ê±°ì£¼ í•œêµ­ì¸ |

### 9.2 íšŒì›ê°€ì… í”Œë¡œìš°

> **ì˜µì…˜ A ì ìš©**: SNS ê°€ì… â†’ ì¦‰ì‹œ ì „í™”ë²ˆí˜¸ ì¸ì¦ (í•„ìˆ˜)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 STEP 1: SNS ë¡œê·¸ì¸                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              ğŸ“± Zaloë¡œ ì‹œì‘í•˜ê¸°                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              ğŸ“˜ Facebookìœ¼ë¡œ ì‹œì‘í•˜ê¸°            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              ğŸ” Googleë¡œ ì‹œì‘í•˜ê¸°                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              STEP 2: ì „í™”ë²ˆí˜¸ ì¸ì¦ (í•„ìˆ˜)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   ë² íŠ¸ë‚¨ ë²•ë ¹(Decree 147/2024)ì— ë”°ë¼                    â”‚
â”‚   ì „í™”ë²ˆí˜¸ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.                            â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   ğŸ“ ì „í™”ë²ˆí˜¸    â”‚  +84 â”‚ 0912-345-678         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              ì¸ì¦ë²ˆí˜¸ ë°›ê¸°                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              STEP 3: ì¸ì¦ë²ˆí˜¸ ì…ë ¥                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   +84 912-345-678 ë¡œ ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í–ˆìŠµë‹ˆë‹¤.            â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  1  â”‚ â”‚  2  â”‚ â”‚  3  â”‚ â”‚  4  â”‚ â”‚  5  â”‚ â”‚  6  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚   ì¸ì¦ë²ˆí˜¸ ì¬ë°œì†¡ (00:59)                               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              âœ… ê°€ì… ì™„ë£Œ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   í™˜ì˜í•©ë‹ˆë‹¤! ì´ì œ ì²­ì²©ì¥ì„ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.               â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              ì²­ì²©ì¥ ë§Œë“¤ê¸°                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 ì¸ì¦ ìƒíƒœ ê´€ë¦¬

| ìƒíƒœ | ì„¤ëª… | ì ‘ê·¼ ê°€ëŠ¥ |
|------|------|----------|
| `guest` | ë¹„ë¡œê·¸ì¸ | ê³µê°œ í˜ì´ì§€ë§Œ |
| `pending_phone` | SNS ì¸ì¦ ì™„ë£Œ, ì „í™” ë¯¸ì¸ì¦ | ì „í™” ì¸ì¦ í˜ì´ì§€ë§Œ |
| `verified` | ì „í™” ì¸ì¦ ì™„ë£Œ | ì „ì²´ ì„œë¹„ìŠ¤ |

### 9.4 Supabase Auth ì„¤ì •

```typescript
// lib/supabase/auth.ts

// ì†Œì…œ ë¡œê·¸ì¸
export async function signInWithProvider(provider: 'zalo' | 'facebook' | 'google') {
  return supabase.auth.signInWithOAuth({
    provider,
    options: {
      redirectTo: `${origin}/auth/callback`,
    },
  })
}

// ì „í™”ë²ˆí˜¸ ì¸ì¦ ìš”ì²­
export async function requestPhoneVerification(phone: string) {
  return supabase.auth.updateUser({
    phone,
  })
}

// OTP í™•ì¸
export async function verifyPhone(token: string) {
  return supabase.auth.verifyOtp({
    type: 'phone_change',
    token,
  })
}

// ì¸ì¦ ìƒíƒœ í™•ì¸
export function getAuthStatus(user: User): 'guest' | 'pending_phone' | 'verified' {
  if (!user) return 'guest'
  if (!user.phone_confirmed_at) return 'pending_phone'
  return 'verified'
}
```

### 9.5 ë² íŠ¸ë‚¨ ë²•ë ¹ ì¤€ìˆ˜

> **Decree 147/2024/ND-CP** (2024ë…„ 12ì›” 25ì¼ ì‹œí–‰)

| ìš”êµ¬ì‚¬í•­ | ëŒ€ì‘ |
|----------|------|
| ì „í™”ë²ˆí˜¸ ì¸ì¦ í•„ìˆ˜ | íšŒì›ê°€ì… ì‹œ í•„ìˆ˜ OTP ì¸ì¦ |
| ì‹ ë¶„ì¦ ì¸ì¦ | ì†Œì…œ ë¡œê·¸ì¸ + ì „í™”ë²ˆí˜¸ë¡œ ëŒ€ì²´ |
| ì½˜í…ì¸  ê²Œì‹œì ì¸ì¦ | verified ìƒíƒœë§Œ ì²­ì²©ì¥ ìƒì„± ê°€ëŠ¥ |

---

## 10. ë³´ì•ˆ ì„¤ê³„

### 10.1 ê¶Œí•œ
- RLS (Row Level Security)
- ë³¸ì¸ ì²­ì²©ì¥ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
- `verified` ì‚¬ìš©ìë§Œ ì½˜í…ì¸  ìƒì„±

### 10.2 ë°ì´í„° ë³´í˜¸
- HTTPS í•„ìˆ˜
- í™˜ê²½ë³€ìˆ˜ë¡œ í‚¤ ê´€ë¦¬
- ì´ë¯¸ì§€ URL ì„œëª…

### 10.3 ì„¸ì…˜ ê´€ë¦¬
- JWT í† í° ê¸°ë°˜
- Refresh Token ìë™ ê°±ì‹ 
- 30ì¼ ì„¸ì…˜ ìœ ì§€

---

## 11. ë‹¤ìŒ ë‹¨ê³„

- [ ] ì™€ì´ì–´í”„ë ˆì„ ìƒì„¸í™”
- [ ] UI ì»´í¬ë„ŒíŠ¸ ê°œë°œ
- [ ] Supabase ì…‹ì—… (Auth í¬í•¨)
- [ ] ì†Œì…œ ë¡œê·¸ì¸ ì—°ë™ (Zalo, Facebook, Google)
- [ ] ì „í™”ë²ˆí˜¸ ì¸ì¦ êµ¬í˜„
- [ ] ì²­ì²©ì¥ ìƒì„± ê¸°ëŠ¥ ê°œë°œ
